version: "3.8"
services:
  app:
    image: ghcr.io/fluidattacks/makes:22.07
    entrypoint:
      - "m"
      - "github:${BRANCH}/makes-example@main"
      - "/api"
      - "${BRANCH}"
    ports:
      - "8080"
    labels:
      - "traefik.enable=true"
      - "traefik.http.middlewares.makes-example-${BRANCH}.stripprefix.prefixes=/${BRANCH}"
      - "traefik.http.routers.makes-example-${BRANCH}.tls.certresolver=letsencrypt"
      - "traefik.http.routers.makes-example-${BRANCH}.rule=Host(`yuaaxr.stackhero-network.com`) && PathPrefix(`/${BRANCH}`)"
      - "traefik.http.routers.makes-example-${BRANCH}.middlewares=makes-example-${BRANCH}"
